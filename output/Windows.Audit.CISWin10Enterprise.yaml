
name: Windows.Audit.CISWin10Enterprise
description: |
   This artifact was generated from the Wazuh SCA project.
   
parameters:
- name: OverruleChecks
  default: |
    Id,Title,Reason
    0,RuleTitle,Reason For Overruling

- name: Remediate
  type: bool
  description: If enabled we remediate the configuration if possible.

- name: ContextLength
  type: int
  description: Length of context to return
  default: 100

sources:
- name: FailedChecks
  query: |
    
    LET JSONEnv = "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"
    LET Env <= parse_json(data=gunzip(string=base64decode(string=JSONEnv)))
    
    LET C(E) = if(condition=E, then=1, else=0)
    
    LET OverruleChecks <= SELECT * FROM if(
        condition=format(format="%T", args=OverruleChecks) =~ "string",
        then={ SELECT * FROM parse_csv(filename=OverruleChecks, accessor='data')})
    
    LET O <= OverruleChecks.Id
    
    LET _Cmd(cmd) = SELECT Stdout
      FROM execve(argv=commandline_split(command=cmd), length=1000000)
    
    LET CmdOut(cmd, re) = parse_string_with_regex(regex=re,
        string=cache(func=_Cmd(cmd=cmd)[0].Stdout, key=cmd))
    
    LET M <= '(?m)'
    
    LET CmdMatch(cmd, re) = cache(func=_Cmd(cmd=cmd)[0].Stdout, key=cmd) =~ M+re
    LET CmdContext(cmd, re) = format(format="match '%v' on '%v': %v", args=[re,
           cmd, cache(func=_Cmd(cmd=cmd)[0].Stdout, key=cmd)[:ContextLength] ])
    
    LET _Reg(Path) = SELECT Data FROM stat(filename=Path, accessor="registry")
    
    LET Reg(k) = _Reg(Path=k)[0].Data
    
    LET FMatch(f, re) = read_file(filename=f) =~ M+re
    LET FContext(f, re) = format(format="match '%v' on file '%v': %v", args=[re,
         f, read_file(filename=f, length=ContextLength)])
    
    LET RunPowerShell(S) = SELECT * FROM execve(
        argv=["Powershell", "-ExecutionPolicy",
              "unrestricted", "-EncodedCommand",
              base64encode(string=utf16_encode(string=S))])
    
    
    
    LET Check15500 <= SELECT * FROM chain(
    t0={
      SELECT 15500 AS Id, 0 AS TestId, Title,
         C(E=Value  >= 24) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15500`.`0`)
      })
    })
    
    LET Check15500Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15500
    GROUP BY 1
    
    
    LET Check15501 <= SELECT * FROM chain(
    t0={
      SELECT 15501 AS Id, 0 AS TestId, Title,
         C(E=Value  <= 365) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15501`.`0`)
      })
    },
    t1={
      SELECT 15501 AS Id, 1 AS TestId, Title,
         C(E=Value  > 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15501`.`1`)
      })
    })
    
    LET Check15501Status <= SELECT Id, Title, sum(item=pass) = 2 OR Id IN O AS OK
    FROM Check15501
    GROUP BY 1
    
    
    LET Check15502 <= SELECT * FROM chain(
    t0={
      SELECT 15502 AS Id, 0 AS TestId, Title,
         C(E=Value  >= 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15502`.`0`)
      })
    })
    
    LET Check15502Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15502
    GROUP BY 1
    
    
    LET Check15503 <= SELECT * FROM chain(
    t0={
      SELECT 15503 AS Id, 0 AS TestId, Title,
         C(E=Value  >= 14) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15503`.`0`)
      })
    })
    
    LET Check15503Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15503
    GROUP BY 1
    
    
    LET Check15505 <= SELECT * FROM chain(
    t0={
      SELECT 15505 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15505`.`0`)
      })
    },
    t1={
      SELECT 15505 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15505`.`1`)
      })
    },
    t2={
      SELECT 15505 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15505`.`2`)
      })
    })
    
    LET Check15505Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15505
    GROUP BY 1
    
    
    LET Check15506 <= SELECT * FROM chain(
    t0={
      SELECT 15506 AS Id, 0 AS TestId, Title,
         C(E=Value  >= 15) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15506`.`0`)
      })
    })
    
    LET Check15506Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15506
    GROUP BY 1
    
    
    LET Check15507 <= SELECT * FROM chain(
    t0={
      SELECT 15507 AS Id, 0 AS TestId, Title,
         C(E=Value  > 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15507`.`0`)
      })
    },
    t1={
      SELECT 15507 AS Id, 1 AS TestId, Title,
         C(E=Value  <= 5) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15507`.`1`)
      })
    })
    
    LET Check15507Status <= SELECT Id, Title, sum(item=pass) = 2 OR Id IN O AS OK
    FROM Check15507
    GROUP BY 1
    
    
    LET Check15508 <= SELECT * FROM chain(
    t0={
      SELECT 15508 AS Id, 0 AS TestId, Title,
         C(E=Value  >= 15) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15508`.`0`)
      })
    })
    
    LET Check15508Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15508
    GROUP BY 1
    
    
    LET Check15509 <= SELECT * FROM chain(
    t0={
      SELECT 15509 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15509`.`0`)
      })
    },
    t1={
      SELECT 15509 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15509`.`1`)
      })
    })
    
    LET Check15509Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15509
    GROUP BY 1
    
    
    LET Check15510 <= SELECT * FROM chain(
    t0={
      SELECT 15510 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15510`.`0`)
      })
    },
    t1={
      SELECT 15510 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15510`.`1`)
      })
    },
    t2={
      SELECT 15510 AS Id, 2 AS TestId, Title,
         C(E=Value = 3) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15510`.`2`)
      })
    })
    
    LET Check15510Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15510
    GROUP BY 1
    
    
    LET Check15511 <= SELECT * FROM chain(
    t0={
      SELECT 15511 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15511`.`0`)
      })
    })
    
    LET Check15511Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15511
    GROUP BY 1
    
    
    LET Check15512 <= SELECT * FROM chain(
    t0={
      SELECT 15512 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15512`.`0`)
      })
    },
    t1={
      SELECT 15512 AS Id, 1 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15512`.`1`)
      })
    })
    
    LET Check15512Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15512
    GROUP BY 1
    
    
    LET Check15513 <= SELECT * FROM chain(
    t0={
      SELECT 15513 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15513`.`0`)
      })
    })
    
    LET Check15513Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15513
    GROUP BY 1
    
    
    LET Check15514 <= SELECT * FROM chain(
    t0={
      SELECT 15514 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15514`.`0`)
      })
    })
    
    LET Check15514Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15514
    GROUP BY 1
    
    
    LET Check15515 <= SELECT * FROM chain(
    t0={
      SELECT 15515 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15515`.`0`)
      })
    },
    t1={
      SELECT 15515 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15515`.`1`)
      })
    },
    t2={
      SELECT 15515 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15515`.`2`)
      })
    })
    
    LET Check15515Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15515
    GROUP BY 1
    
    
    LET Check15516 <= SELECT * FROM chain(
    t0={
      SELECT 15516 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15516`.`0`)
      })
    },
    t1={
      SELECT 15516 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15516`.`1`)
      })
    },
    t2={
      SELECT 15516 AS Id, 2 AS TestId, Title,
         C(E=Value = 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15516`.`2`)
      })
    })
    
    LET Check15516Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15516
    GROUP BY 1
    
    
    LET Check15517 <= SELECT * FROM chain(
    t0={
      SELECT 15517 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15517`.`0`)
      })
    },
    t1={
      SELECT 15517 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15517`.`1`)
      })
    },
    t2={
      SELECT 15517 AS Id, 2 AS TestId, Title,
         C(E=Value = 2) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15517`.`2`)
      })
    })
    
    LET Check15517Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15517
    GROUP BY 1
    
    
    LET Check15518 <= SELECT * FROM chain(
    t0={
      SELECT 15518 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15518`.`0`)
      })
    },
    t1={
      SELECT 15518 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15518`.`1`)
      })
    },
    t2={
      SELECT 15518 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15518`.`2`)
      })
    })
    
    LET Check15518Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15518
    GROUP BY 1
    
    
    LET Check15519 <= SELECT * FROM chain(
    t0={
      SELECT 15519 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15519`.`0`)
      })
    },
    t1={
      SELECT 15519 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15519`.`1`)
      })
    },
    t2={
      SELECT 15519 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15519`.`2`)
      })
    })
    
    LET Check15519Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15519
    GROUP BY 1
    
    
    LET Check15520 <= SELECT * FROM chain(
    t0={
      SELECT 15520 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15520`.`0`)
      })
    },
    t1={
      SELECT 15520 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15520`.`1`)
      })
    },
    t2={
      SELECT 15520 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15520`.`2`)
      })
    })
    
    LET Check15520Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15520
    GROUP BY 1
    
    
    LET Check15521 <= SELECT * FROM chain(
    t0={
      SELECT 15521 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15521`.`0`)
      })
    },
    t1={
      SELECT 15521 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15521`.`1`)
      })
    },
    t2={
      SELECT 15521 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15521`.`2`)
      })
    })
    
    LET Check15521Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15521
    GROUP BY 1
    
    
    LET Check15522 <= SELECT * FROM chain(
    t0={
      SELECT 15522 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15522`.`0`)
      })
    },
    t1={
      SELECT 15522 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15522`.`1`)
      })
    },
    t2={
      SELECT 15522 AS Id, 2 AS TestId, Title,
         C(E=Value = 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15522`.`2`)
      })
    })
    
    LET Check15522Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15522
    GROUP BY 1
    
    
    LET Check15523 <= SELECT * FROM chain(
    t0={
      SELECT 15523 AS Id, 0 AS TestId, Title,
         C(E=Value  <= 30) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15523`.`0`)
      })
    },
    t1={
      SELECT 15523 AS Id, 1 AS TestId, Title,
         C(E=Value  > 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=CmdOut(cmd=cmd, re=re).g1 || 0) AS Value, '' AS Context
        FROM foreach(row=Env.`15523`.`1`)
      })
    })
    
    LET Check15523Status <= SELECT Id, Title, sum(item=pass) = 2 OR Id IN O AS OK
    FROM Check15523
    GROUP BY 1
    
    
    LET Check15524 <= SELECT * FROM chain(
    t0={
      SELECT 15524 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15524`.`0`)
      })
    },
    t1={
      SELECT 15524 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15524`.`1`)
      })
    },
    t2={
      SELECT 15524 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15524`.`2`)
      })
    })
    
    LET Check15524Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15524
    GROUP BY 1
    
    
    LET Check15525 <= SELECT * FROM chain(
    t0={
      SELECT 15525 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15525`.`0`)
      })
    },
    t1={
      SELECT 15525 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15525`.`1`)
      })
    },
    t2={
      SELECT 15525 AS Id, 2 AS TestId, Title,
         C(E=Value = 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15525`.`2`)
      })
    })
    
    LET Check15525Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15525
    GROUP BY 1
    
    
    LET Check15526 <= SELECT * FROM chain(
    t0={
      SELECT 15526 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15526`.`0`)
      })
    },
    t1={
      SELECT 15526 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15526`.`1`)
      })
    },
    t2={
      SELECT 15526 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15526`.`2`)
      })
    })
    
    LET Check15526Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15526
    GROUP BY 1
    
    
    LET Check15527 <= SELECT * FROM chain(
    t0={
      SELECT 15527 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15527`.`0`)
      })
    },
    t1={
      SELECT 15527 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15527`.`1`)
      })
    },
    t2={
      SELECT 15527 AS Id, 2 AS TestId, Title,
         C(E=NOT Value = 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15527`.`2`)
      })
    },
    t3={
      SELECT 15527 AS Id, 3 AS TestId, Title,
         C(E=Value <=30) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=Reg(k=k + '/' + v).value) AS Value, '' AS Context
        FROM foreach(row=Env.`15527`.`3`)
      })
    })
    
    LET Check15527Status <= SELECT Id, Title, sum(item=pass) = 4 OR Id IN O AS OK
    FROM Check15527
    GROUP BY 1
    
    
    LET Check15528 <= SELECT * FROM chain(
    t0={
      SELECT 15528 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15528`.`0`)
      })
    },
    t1={
      SELECT 15528 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15528`.`1`)
      })
    },
    t2={
      SELECT 15528 AS Id, 2 AS TestId, Title,
         C(E=NOT Value = 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15528`.`2`)
      })
    },
    t3={
      SELECT 15528 AS Id, 3 AS TestId, Title,
         C(E=Value <= 900) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=Reg(k=k + '/' + v).value) AS Value, '' AS Context
        FROM foreach(row=Env.`15528`.`3`)
      })
    })
    
    LET Check15528Status <= SELECT Id, Title, sum(item=pass) = 4 OR Id IN O AS OK
    FROM Check15528
    GROUP BY 1
    
    
    LET Check15529 <= SELECT * FROM chain(
    t0={
      SELECT 15529 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15529`.`0`)
      })
    })
    
    LET Check15529Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15529
    GROUP BY 1
    
    
    LET Check15530 <= SELECT * FROM chain(
    t0={
      SELECT 15530 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15530`.`0`)
      })
    })
    
    LET Check15530Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15530
    GROUP BY 1
    
    
    LET Check15531 <= SELECT * FROM chain(
    t0={
      SELECT 15531 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15531`.`0`)
      })
    },
    t1={
      SELECT 15531 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15531`.`1`)
      })
    },
    t2={
      SELECT 15531 AS Id, 2 AS TestId, Title,
         C(E=Value <= 4) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=Reg(k=k + '/' + v).value) AS Value, '' AS Context
        FROM foreach(row=Env.`15531`.`2`)
      })
    })
    
    LET Check15531Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15531
    GROUP BY 1
    
    
    LET Check15532 <= SELECT * FROM chain(
    t0={
      SELECT 15532 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15532`.`0`)
      })
    },
    t1={
      SELECT 15532 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15532`.`1`)
      })
    },
    t2={
      SELECT 15532 AS Id, 2 AS TestId, Title,
         C(E=Value <= 14) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=Reg(k=k + '/' + v).value) AS Value, '' AS Context
        FROM foreach(row=Env.`15532`.`2`)
      })
    })
    
    LET Check15532Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15532
    GROUP BY 1
    
    
    LET Check15533 <= SELECT * FROM chain(
    t0={
      SELECT 15533 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15533`.`0`)
      })
    },
    t1={
      SELECT 15533 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15533`.`1`)
      })
    },
    t2={
      SELECT 15533 AS Id, 2 AS TestId, Title,
         C(E=Value =~ regex) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15533`.`2`)
      })
    })
    
    LET Check15533Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15533
    GROUP BY 1
    
    
    LET Check15534 <= SELECT * FROM chain(
    t0={
      SELECT 15534 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15534`.`0`)
      })
    },
    t1={
      SELECT 15534 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15534`.`1`)
      })
    },
    t2={
      SELECT 15534 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15534`.`2`)
      })
    })
    
    LET Check15534Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15534
    GROUP BY 1
    
    
    LET Check15535 <= SELECT * FROM chain(
    t0={
      SELECT 15535 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15535`.`0`)
      })
    },
    t1={
      SELECT 15535 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15535`.`1`)
      })
    },
    t2={
      SELECT 15535 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15535`.`2`)
      })
    })
    
    LET Check15535Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15535
    GROUP BY 1
    
    
    LET Check15536 <= SELECT * FROM chain(
    t0={
      SELECT 15536 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15536`.`0`)
      })
    },
    t1={
      SELECT 15536 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15536`.`1`)
      })
    },
    t2={
      SELECT 15536 AS Id, 2 AS TestId, Title,
         C(E=Value = 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15536`.`2`)
      })
    })
    
    LET Check15536Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15536
    GROUP BY 1
    
    
    LET Check15537 <= SELECT * FROM chain(
    t0={
      SELECT 15537 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15537`.`0`)
      })
    },
    t1={
      SELECT 15537 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15537`.`1`)
      })
    },
    t2={
      SELECT 15537 AS Id, 2 AS TestId, Title,
         C(E=Value <= 15) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=Reg(k=k + '/' + v).value) AS Value, '' AS Context
        FROM foreach(row=Env.`15537`.`2`)
      })
    })
    
    LET Check15537Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15537
    GROUP BY 1
    
    
    LET Check15538 <= SELECT * FROM chain(
    t0={
      SELECT 15538 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15538`.`0`)
      })
    },
    t1={
      SELECT 15538 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15538`.`1`)
      })
    },
    t2={
      SELECT 15538 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15538`.`2`)
      })
    })
    
    LET Check15538Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15538
    GROUP BY 1
    
    
    LET Check15539 <= SELECT * FROM chain(
    t0={
      SELECT 15539 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15539`.`0`)
      })
    },
    t1={
      SELECT 15539 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15539`.`1`)
      })
    },
    t2={
      SELECT 15539 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15539`.`2`)
      })
    })
    
    LET Check15539Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15539
    GROUP BY 1
    
    
    LET Check15540 <= SELECT * FROM chain(
    t0={
      SELECT 15540 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15540`.`0`)
      })
    },
    t1={
      SELECT 15540 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15540`.`1`)
      })
    },
    t2={
      SELECT 15540 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15540`.`2`)
      })
    })
    
    LET Check15540Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15540
    GROUP BY 1
    
    
    LET Check15541 <= SELECT * FROM chain(
    t0={
      SELECT 15541 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15541`.`0`)
      })
    },
    t1={
      SELECT 15541 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15541`.`1`)
      })
    },
    t2={
      SELECT 15541 AS Id, 2 AS TestId, Title,
         C(E=Value >= 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, int(int=Reg(k=k + '/' + v).value) AS Value, '' AS Context
        FROM foreach(row=Env.`15541`.`2`)
      })
    })
    
    LET Check15541Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15541
    GROUP BY 1
    
    
    LET Check15542 <= SELECT * FROM chain(
    t0={
      SELECT 15542 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, CmdMatch(cmd=cmd, re=re) AS Value, CmdContext(cmd=cmd, re=re) AS Context
        FROM foreach(row=Env.`15542`.`0`)
      })
    })
    
    LET Check15542Status <= SELECT Id, Title, sum(item=pass) = 1 OR Id IN O AS OK
    FROM Check15542
    GROUP BY 1
    
    
    LET Check15543 <= SELECT * FROM chain(
    t0={
      SELECT 15543 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15543`.`0`)
      })
    },
    t1={
      SELECT 15543 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15543`.`1`)
      })
    },
    t2={
      SELECT 15543 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15543`.`2`)
      })
    })
    
    LET Check15543Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15543
    GROUP BY 1
    
    
    LET Check15544 <= SELECT * FROM chain(
    t0={
      SELECT 15544 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15544`.`0`)
      })
    },
    t1={
      SELECT 15544 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15544`.`1`)
      })
    },
    t2={
      SELECT 15544 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15544`.`2`)
      })
    })
    
    LET Check15544Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15544
    GROUP BY 1
    
    
    LET Check15545 <= SELECT * FROM chain(
    t0={
      SELECT 15545 AS Id, 0 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15545`.`0`)
      })
    },
    t1={
      SELECT 15545 AS Id, 1 AS TestId, Title,
         C(E=Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15545`.`1`)
      })
    },
    t2={
      SELECT 15545 AS Id, 2 AS TestId, Title,
         C(E=Value = 1) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15545`.`2`)
      })
    })
    
    LET Check15545Status <= SELECT Id, Title, sum(item=pass) = 3 OR Id IN O AS OK
    FROM Check15545
    GROUP BY 1
    
    
    LET Check15546 <= SELECT * FROM chain(
    t0={
      SELECT 15546 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15546`.`0`)
      })
    },
    t1={
      SELECT 15546 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15546`.`1`)
      })
    },
    t2={
      SELECT 15546 AS Id, 2 AS TestId, Title,
         C(E=Value = 0) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15546`.`2`)
      })
    })
    
    LET Check15546Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15546
    GROUP BY 1
    
    
    LET Check15547 <= SELECT * FROM chain(
    t0={
      SELECT 15547 AS Id, 0 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k) AS Value, '' AS Context
        FROM foreach(row=Env.`15547`.`0`)
      })
    },
    t1={
      SELECT 15547 AS Id, 1 AS TestId, Title,
         C(E=NOT Value) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v) AS Value, '' AS Context
        FROM foreach(row=Env.`15547`.`1`)
      })
    },
    t2={
      SELECT 15547 AS Id, 2 AS TestId, Title,
         C(E=NOT Value =~ regex) AS pass, Value, expected, Context
      FROM foreach(row={
        SELECT *, Reg(k=k + '/' + v).value AS Value, '' AS Context
        FROM foreach(row=Env.`15547`.`2`)
      })
    })
    
    LET Check15547Status <= SELECT Id, Title, sum(item=pass) > 0 OR Id IN O AS OK
    FROM Check15547
    GROUP BY 1
    
    LET Failures <= SELECT * FROM chain(a0=Check15500Status,
     a1=Check15501Status,
     a2=Check15502Status,
     a3=Check15503Status,
     a4=Check15505Status,
     a5=Check15506Status,
     a6=Check15507Status,
     a7=Check15508Status,
     a8=Check15509Status,
     a9=Check15510Status,
     a10=Check15511Status,
     a11=Check15512Status,
     a12=Check15513Status,
     a13=Check15514Status,
     a14=Check15515Status,
     a15=Check15516Status,
     a16=Check15517Status,
     a17=Check15518Status,
     a18=Check15519Status,
     a19=Check15520Status,
     a20=Check15521Status,
     a21=Check15522Status,
     a22=Check15523Status,
     a23=Check15524Status,
     a24=Check15525Status,
     a25=Check15526Status,
     a26=Check15527Status,
     a27=Check15528Status,
     a28=Check15529Status,
     a29=Check15530Status,
     a30=Check15531Status,
     a31=Check15532Status,
     a32=Check15533Status,
     a33=Check15534Status,
     a34=Check15535Status,
     a35=Check15536Status,
     a36=Check15537Status,
     a37=Check15538Status,
     a38=Check15539Status,
     a39=Check15540Status,
     a40=Check15541Status,
     a41=Check15542Status,
     a42=Check15543Status,
     a43=Check15544Status,
     a44=Check15545Status,
     a45=Check15546Status,
     a46=Check15547Status)
    WHERE NOT OK
    
    LET AllTests <= SELECT * FROM chain(a0=Check15500,
     a1=Check15501,
     a2=Check15502,
     a3=Check15503,
     a4=Check15505,
     a5=Check15506,
     a6=Check15507,
     a7=Check15508,
     a8=Check15509,
     a9=Check15510,
     a10=Check15511,
     a11=Check15512,
     a12=Check15513,
     a13=Check15514,
     a14=Check15515,
     a15=Check15516,
     a16=Check15517,
     a17=Check15518,
     a18=Check15519,
     a19=Check15520,
     a20=Check15521,
     a21=Check15522,
     a22=Check15523,
     a23=Check15524,
     a24=Check15525,
     a25=Check15526,
     a26=Check15527,
     a27=Check15528,
     a28=Check15529,
     a29=Check15530,
     a30=Check15531,
     a31=Check15532,
     a32=Check15533,
     a33=Check15534,
     a34=Check15535,
     a35=Check15536,
     a36=Check15537,
     a37=Check15538,
     a38=Check15539,
     a39=Check15540,
     a40=Check15541,
     a41=Check15542,
     a42=Check15543,
     a43=Check15544,
     a44=Check15545,
     a45=Check15546,
     a46=Check15547)
    
    SELECT * FROM Failures

- name: FailedTests
  query: |
    -- For failed checks show all tests
    SELECT Id, TestId, CheckDetails, Value, Context, pass
    FROM foreach(row={
      SELECT Id AS FailedId FROM Failures
    },
    query={
      SELECT *,
         get(item=Env,
             member=format(format="%v.%v", args=[Id, TestId])) AS CheckDetails
      FROM AllTests
      WHERE Id = FailedId
    })

- name: AllTests
  query: |
    SELECT *,
      get(item=Env,
          member=format(format="%v.%v", args=[Id, TestId])) AS CheckDetails
    FROM AllTests

- name: Remediation
  query: |
    
    SELECT * FROM if(condition=Remediate, then={
      SELECT * FROM chain(
      r110={ SELECT Id, Title,
             RunPowerShell(S='Get-Service WpnService | Stop-Service -PassThru | Set-Service -StartupType Disabled')
       AS _Result
             FROM Check15611Status WHERE NOT OK }
    )})
    

- name: Stats
  query: |
    LET TotalFailed <= SELECT count() AS Total FROM Failures GROUP BY 1
    LET TotalChecks <= 394

    SELECT TotalFailed[0].Total AS TotalFailed, TotalChecks FROM scope()

